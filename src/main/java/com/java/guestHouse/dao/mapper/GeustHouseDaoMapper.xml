<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.GuestHouseMapper">

	<select id="guestHouseRead" resultType="com.java.host.dto.HostDto">
		select * from house where houseCode=#{houseCode}
	</select>
	
	<select id="guestHouseImgList" parameterType="java.util.Map" resultType="com.java.file.dto.FileDto">
		select * from filelist where houseCode=#{houseCode}
	</select>
	
	<select id="getMemberCode" parameterType="String" resultType="int">
		select membercode from member where email=#{email}
	</select>

	<select id="getPrice" resultType="int">
		select price from house where houseCode=#{houseCode}
	</select>
	
	<select id="getHostMemberCode" resultType="int">
		select membercode from house where houseCode=#{houseCode}
	</select>
	
	<select id="getHostInfo" resultType="com.java.host.dto.HostDto">
		select * from house where houseCode=#{houseCode}
	</select>

	<select id="getMemberPoint" resultType="int">
		select point from member where email=#{email}
	</select>
	
	<select id="getHost" resultType="com.java.member.dto.MemberDto">
		select * from member where memberCode=#{hostCode}
	</select>
	
	<select id="getHouseName" resultType="String">
		select houseName from house where houseCode=#{houseCode}
	</select>
	
	<insert id="insertReserveInfo" parameterType="com.java.guestReserve.dto.GuestReserveDto">
		insert into 
		RESERVATION(reserveCode,memberCode,houseCode,reserveDate,checkIn,checkOut,state,payment,people)
		values(seq_reserveCode_num.nextval,#{memberCode},#{houseCode},#{reserveDate},#{checkIn},#{checkOut},#{state},#{payment},#{people})
	</insert>
	
	<select id="getReserveCode" parameterType="java.util.Map" resultType="int">
		select reserveCode from RESERVATION where houseCode=#{houseCode} and memberCode=#{memberCode} and checkIn=#{checkIn}
	</select>
	
	<update id="updatePoint" parameterType="java.util.Map" >
		update member set point =#{memberPoint} where memberCode=#{memberCode}
	</update>
	
	<insert id="insertResPoint" parameterType="com.java.guestdelluna.dto.PointAccumulate">
		insert into
		POINTACCUMULATE(accuCode,memberCode,accuPlace,accuDate,accuPoint)
		values(seq_accuCode_num.nextval,#{memberCode},#{accuPlace},#{accuDate},#{accuPoint})
	</insert>
	
	<insert id="insertUsePoint" parameterType="com.java.guestdelluna.dto.PointUse">
		insert into
		POINTUSE(useCode,memberCode,usePlace,useDate,usePoint)
		values(seq_useCode_num.nextval,#{memberCode},#{usePlace},#{useDate},#{usePoint})
	</insert>
	
	<insert id="insertRemain" parameterType="java.util.Map">
		insert into
		REMAIN(resDate,people,houseCode)
		values(#{resDate},#{people},#{houseCode})
	</insert>
	
	<select id="getRemain" parameterType="int" resultType="com.java.guestReserve.dto.RemainDto">
		select resDate,sum(people) as people from remain where houseCode=#{houseCode} group by resDate
	</select>
	
	<select id="getMemberInfo" resultType="com.java.member.dto.MemberDto">
		select * from member where email=#{email}
	</select>
	
	<insert id="insertMsg" parameterType="com.java.guestdelluna.dto.MsgDto">
		insert into
		message(msgCode,memberCode,msgContent,msgDate,msgCheck)
		values(seq_msgCode_num.nextval,#{memberCode},#{msgContent},#{msgDate},#{msgCheck})
	</insert>
	
</mapper>






