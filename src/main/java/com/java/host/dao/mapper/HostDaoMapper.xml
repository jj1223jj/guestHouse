<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="host.dao.mapper">
  <insert id="subImgUpload" parameterType="com.java.file.dto.FileDto">
  	 insert into FileList(fileCode, fileName, filePath, fileSize, houseCode) values(seq_fileList_num.nextval, #{fileName}, #{filePath}, #{fileSize}, #{houseCode})
  </insert>
  
  <update id="memberProfileUpdate" parameterType="java.util.Map">
  	update member set MemberImgSize = #{memberImgSize}, MemberImgName = #{memberImgName}, MemberImgPath = #{memberImgPath}, MemberInfo = #{memberInfo} where email = #{email}
  </update>
  
  <select id="memberCode" parameterType="String" resultType="int">
  	select memberCode from member where email = #{email}
  </select>
  
  <insert id="hostRegister" parameterType="com.java.host.dto.HostDto">
  	insert into house(houseCode, memberCode, houseName,explain,bath,etc,checkInTime,checkOutTime,necessary,wifi,washer,hotWater,aircon,
  	tv,mart,parking,kitchen,safety,address,sido,sigungu,roadName,bName,jibunAddress,latLng,detailAddress,local,approvalStatus,
  	bank,account,people,bed,price,houseRegDate)
  	 values(seq_house_num.nextval, #{memberCode},#{houseName},
  	#{explain},#{bath},#{etc},#{checkInTime},
  	#{checkOutTime},#{necessary},#{wifi},#{washer},#{hotWater},#{aircon},#{tv},#{mart},
  	#{parking},#{kitchen},#{safety},#{address}, #{sido}, #{sigungu}, #{roadName}, #{bName},
  	 #{jibunAddress}, #{latLng}, #{detailAddress}, #{local}, #{approvalStatus}, #{bank}, 
  	 #{account}, #{people}, #{bed}, #{price}, #{houseRegDate})
  </insert>
  
  <insert id="mainImgUpload" parameterType="com.java.file.dto.FileDto">
  	 insert into FileList(fileCode, mainImgName, filePath, fileSize, houseCode) values(seq_fileList_num.nextval, #{mainImgName}, #{filePath}, #{fileSize}, #{houseCode})
  </insert>
  
  <select id="houseCode" resultType="int">
  	select max(houseCode) from house
  </select>
  
  <select id="houseList" parameterType="int" resultType="com.java.host.dto.HostDto">
  	select * from house where memberCode = #{memberCode}
  </select>
  
  <update id="hostCancel" parameterType="int">
  	update house set approvalStatus = '삭제' where housecode = #{houseCode}
  </update>
  
  <select id="houseNameList" parameterType="int" resultType="String">
  	select houseName from house where memberCode = #{memberCode} and approvalStatus = '승인완료'
  </select>
  
  <select id="getHouseCode" parameterType="String" resultType="int">
  	select houseCode from house where houseName = #{houseName}
  </select>
  
  <select id="reserveViewList" parameterType="int" resultType="com.java.host.dto.ReservationListDto">
  	select member.memberName, member.email, member.phone, reservation.checkIn, reservation.checkOut, reservation.payment, reservation.state from member natural join reservation where reservation.housecode = #{houseCode}
  </select>
</mapper>